"use strict";var Z=Object.defineProperty;var s=(e,t)=>Z(e,"name",{value:t,configurable:!0});var B=require("os"),P=require("stream");function ee(e,t=1,r={}){const{indent:o=" ",includeEmptyLines:n=!1}=r;if(typeof e!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(t<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${t}\``);if(typeof o!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof o}\``);if(t===0)return e;const c=n?/^/gm:/^(?!\s*$)/gm;return e.replace(c,o.repeat(t))}s(ee,"indentString");function te(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}s(te,"escapeStringRegexp");const U=/\s+at.*[(\s](.*)\)?/,re=/^(?:(?:(?:node|node:[\w/]+|(?:(?:node:)?internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)(?:\.js)?:\d+:\d+)|native)/,ne=typeof B.homedir=="undefined"?"":B.homedir().replace(/\\/g,"/");function oe(e,{pretty:t=!1,basePath:r}={}){const o=r&&new RegExp(`(at | \\()${te(r.replace(/\\/g,"/"))}`,"g");if(typeof e=="string")return e.replace(/\\/g,"/").split(`
`).filter(n=>{const c=n.match(U);if(c===null||!c[1])return!0;const a=c[1];return a.includes(".app/Contents/Resources/electron.asar")||a.includes(".app/Contents/Resources/default_app.asar")||a.includes("node_modules/electron/dist/resources/electron.asar")||a.includes("node_modules/electron/dist/resources/default_app.asar")?!1:!re.test(a)}).filter(n=>n.trim()!=="").map(n=>(o&&(n=n.replace(o,"$1")),t&&(n=n.replace(U,(c,a)=>c.replace(a,a.replace(ne,"~")))),n)).join(`
`)}s(oe,"cleanStack");var se=Object.defineProperty,Y=s(e=>{throw TypeError(e)},"__typeError"),ie=s((e,t,r)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,"__defNormalProp"),ae=s((e,t,r)=>ie(e,t+"",r),"__publicField"),W=s((e,t,r)=>t.has(e)||Y("Cannot "+r),"__accessCheck"),ce=s((e,t,r)=>(W(e,t,"read from private field"),r?r.call(e):t.get(e)),"__privateGet"),le=s((e,t,r)=>t.has(e)?Y("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),"__privateAdd"),ue=s((e,t,r,o)=>(W(e,t,"write to private field"),t.set(e,r),r),"__privateSet"),L;const fe=s(e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),"cleanInternalStack"),A=class A extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=t.map(o=>o instanceof Error?o:o!==null&&typeof o=="object"?Object.assign(new Error(o.message),o):new Error(o));let r=t.map(o=>typeof o.stack=="string"&&o.stack.length>0?fe(oe(o.stack)):String(o)).join(`
`);r=`
`+ee(r,4),super(r),le(this,L),ae(this,"name","AggregateError"),ue(this,L,t)}get errors(){return ce(this,L).slice()}};s(A,"AggregateError");let N=A;L=new WeakMap;const F=class F extends Error{constructor(t){super(),this.name="AbortError",this.message=t}};s(F,"AbortError");let $=F;const G=s(e=>globalThis.DOMException===void 0?new $(e):new DOMException(e),"getDOMException"),V=s(e=>{const t=e.reason===void 0?G("This operation was aborted."):e.reason;return t instanceof Error?t:G(t)},"getAbortedReason");async function pe(e,t,{concurrency:r=Number.POSITIVE_INFINITY,stopOnError:o=!0,signal:n}={}){return new Promise((c,a)=>{if(e[Symbol.iterator]===void 0&&e[Symbol.asyncIterator]===void 0)throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof e})`);if(typeof t!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===Number.POSITIVE_INFINITY)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);const E=[],w=[],p=new Map;let x=!1,_=!1,C=!1,y=0,I=0;const v=e[Symbol.iterator]===void 0?e[Symbol.asyncIterator]():e[Symbol.iterator](),R=s(u=>{x=!0,_=!0,a(u)},"reject");n&&(n.aborted&&R(V(n)),n.addEventListener("abort",()=>{R(V(n))}));const i=s(async()=>{if(_)return;const u=await v.next(),f=I;if(I++,u.done){if(C=!0,y===0&&!_){if(!o&&w.length>0){R(new N(w));return}if(_=!0,p.size===0){c(E);return}const d=[];for(const[g,m]of E.entries())p.get(g)!==j&&d.push(m);c(d)}return}y++,(async()=>{try{const d=await u.value;if(_)return;const g=await t(d,f);g===j&&p.set(f,g),E[f]=g,y--,await i()}catch(d){if(o)R(d);else{w.push(d),y--;try{await i()}catch(g){R(g)}}}})()},"next");(async()=>{for(let u=0;u<r;u++){try{await i()}catch(f){R(f);break}if(C||x)break}})()})}s(pe,"pMap");const j=Symbol("skip"),k=["assert","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"];let b={};const de=s(e=>{const t=new P.PassThrough,r=new P.PassThrough;t.write=n=>{e("stdout",n)},r.write=n=>{e("stderr",n)};const o=new console.Console(t,r);for(const n of k)b[n]=console[n],console[n]=o[n];return()=>{for(const n of k)console[n]=b[n];b={}}},"patchConsole"),H=["\u280B","\u2819","\u2839","\u2838","\u283C","\u2834","\u2826","\u2827","\u2807","\u280F"],l={HIDE_CURSOR:"\x1B[?25l",SHOW_CURSOR:"\x1B[?25h",MOVE_UP:"\x1B[1A",CLEAR_LINE:"\x1B[2K",COLOR_GREEN:"\x1B[32m",COLOR_CYAN:"\x1B[36m",COLOR_RED:"\x1B[31m",COLOR_YELLOW:"\x1B[33m",STYLE_DIM:"\x1B[90m",RESET_FOREGROUND:"\x1B[39m"},S=!!(process.env.CI||process.env.CONTINUOUS_INTEGRATION||process.env.BUILD_NUMBER),Ee=s(e=>process.env.NO_COLOR||process.env.NODE_DISABLE_COLORS?!1:e.hasColors?e.hasColors():process.env.FORCE_COLOR!==void 0?process.env.FORCE_COLOR!=="0":e.isTTY!==!1,"detectColors"),O=s((e,t,r)=>e?`${t}${r}${l.RESET_FOREGROUND}`:r,"colorize"),q=s(e=>{for(const t of e)if(t.state==="loading"||t.state==="pending"||t.children&&t.children.length>0&&!q(t.children))return!1;return!0},"areAllTasksDone"),ge=s((e,t=process.stdout)=>{let r=0,o,n,c="",a=0,E;const w=t.isTTY!==!1,p=Ee(t),x=s((i,u)=>i==="pending"?O(p,l.STYLE_DIM,"\u25FC"):i==="loading"?u?O(p,l.COLOR_YELLOW,"\u276F"):O(p,l.COLOR_CYAN,H[r]):i==="success"?u?O(p,l.COLOR_YELLOW,"\u276F"):O(p,l.COLOR_GREEN,"\u2714"):i==="error"?u?O(p,l.COLOR_RED,"\u276F"):O(p,l.COLOR_RED,"\u2716"):i==="warning"?O(p,l.COLOR_YELLOW,"\u26A0"):O(p,l.STYLE_DIM,"\u25FC"),"getIcon"),_=s((i,u)=>{const f="  ".repeat(u),d=i.children&&i.children.length>0,g=x(i.state,d);let m=`${f}${g} ${i.title}`;if(i.status&&(m+=` [${i.status}]`),m+=`
`,i.output){const Q=`${f}  `,J=s(T=>p?`${l.STYLE_DIM}${T}${l.RESET_FOREGROUND}`:T,"styleText");m+=i.output.split(`
`).map((T,X)=>`${Q}${J(X===0?`\u2192 ${T}`:T)}`).join(`
`)+`
`}return d&&(m+=C(i.children,u+1)),m},"renderTask"),C=s((i,u=0)=>i.map(f=>_(f,u)).join(""),"renderTaskList"),y=s((i,u)=>{if(a>0){for(let f=0;f<a;f+=1)t.write(l.MOVE_UP),t.write(l.CLEAR_LINE);a=0}t.write(u),I()},"handleConsoleOutput"),I=s(()=>{const i=C(e);if(q(e)&&o&&(clearInterval(o),o=void 0),S){i!==c&&(t.write(i),c=i);return}if(a>0)for(let f=0;f<a;f+=1)t.write(l.MOVE_UP),t.write(l.CLEAR_LINE);t.write(i),c=i,a=i.split(`
`).length-1},"render"),v=s(()=>{n||(n=setTimeout(()=>{n=void 0,I()},33))},"scheduleRender"),R=s(()=>{if(o&&clearInterval(o),n&&clearTimeout(n),E&&E(),!S&&w&&a>0)for(let i=0;i<a;i+=1)t.write(l.MOVE_UP),t.write(l.CLEAR_LINE);!S&&w&&t.write(l.SHOW_CURSOR)},"destroy");return!S&&w&&(t.write(l.HIDE_CURSOR),o=setInterval(()=>{r=(r+1)%H.length,v()},80),E=de(y)),v(),{triggerRender:v,destroy:R}},"createRenderer");let D;const Oe=s(e=>{D=e},"setRenderCallback"),Re=s(e=>new Proxy(e,{set(t,r,o){return Reflect.set(t,r,o),D&&D(),!0}}),"reactive"),M=Symbol("run"),he=s(e=>{const t={task:K(e.children),setTitle(r){e.title=r},setStatus(r){e.status=r},setOutput(r){e.output=typeof r=="string"?r:"message"in r?r.message:""},setWarning(r){e.state="warning",r!==void 0&&t.setOutput(r)},setError(r){e.state="error",r!==void 0&&t.setOutput(r)}};return t},"createTaskInnerApi");let h;const z=s((e,t,r)=>{h||(h=ge(e),Oe(()=>h.triggerRender()),e.isRoot=!0);const o=Re({title:t,state:"pending",children:[]});return e.push(o),{task:o,[M]:async()=>{const n=he(o);o.state="loading";let c;try{c=await r(n)}catch(a){throw n.setError(a),a}return o.state==="loading"&&(o.state="success"),c},clear:s(()=>{const n=e.indexOf(o);n!==-1&&e.splice(n,1),h&&h.triggerRender(),e.isRoot&&e.length===0&&h&&(h.destroy(),h=void 0)},"clear")}},"registerTask");function K(e){const t=s(async(r,o)=>{const n=z(e,r,o);return{result:await n[M](),get state(){return n.task.state},clear:n.clear}},"task");return t.group=(async(r,o)=>{const n=r((a,E)=>z(e,a,E)),c=await pe(n,async a=>({result:await a[M](),get state(){return a.task.state},clear:a.clear}),{concurrency:1,...o});return Object.assign(c,{clear:s(()=>{for(const a of n)a.clear()},"clear")})}),t}s(K,"createTaskFunction");const we=[];var _e=K(we);module.exports=_e;
