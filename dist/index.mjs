var Ye=Object.defineProperty;var s=(e,t)=>Ye(e,"name",{value:t,configurable:!0});import V from"os";import{PassThrough as H}from"stream";import D from"process";import ze from"tty";function qe(e,t=1,r={}){const{indent:n=" ",includeEmptyLines:o=!1}=r;if(typeof e!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(t<0)throw new RangeError(`Expected \`count\` to be at least 0, got \`${t}\``);if(typeof n!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n}\``);if(t===0)return e;const a=o?/^/gm:/^(?!\s*$)/gm;return e.replace(a,n.repeat(t))}s(qe,"indentString");function Ve(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}s(Ve,"escapeStringRegexp");const K=/\s+at.*[(\s](.*)\)?/,He=/^(?:(?:(?:node|node:[\w/]+|(?:(?:node:)?internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)(?:\.js)?:\d+:\d+)|native)/,Ke=typeof V.homedir=="undefined"?"":V.homedir().replace(/\\/g,"/");function Qe(e,{pretty:t=!1,basePath:r}={}){const n=r&&new RegExp(`(at | \\()${Ve(r.replace(/\\/g,"/"))}`,"g");if(typeof e=="string")return e.replace(/\\/g,"/").split(`
`).filter(o=>{const a=o.match(K);if(a===null||!a[1])return!0;const i=a[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")||i.includes("node_modules/electron/dist/resources/electron.asar")||i.includes("node_modules/electron/dist/resources/default_app.asar")?!1:!He.test(i)}).filter(o=>o.trim()!=="").map(o=>(n&&(o=o.replace(n,"$1")),t&&(o=o.replace(K,(a,i)=>a.replace(i,i.replace(Ke,"~")))),o)).join(`
`)}s(Qe,"cleanStack");var Je=Object.defineProperty,Q=s(e=>{throw TypeError(e)},"__typeError"),Xe=s((e,t,r)=>t in e?Je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,"__defNormalProp"),Ze=s((e,t,r)=>Xe(e,t+"",r),"__publicField"),J=s((e,t,r)=>t.has(e)||Q("Cannot "+r),"__accessCheck"),et=s((e,t,r)=>(J(e,t,"read from private field"),r?r.call(e):t.get(e)),"__privateGet"),tt=s((e,t,r)=>t.has(e)?Q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),"__privateAdd"),rt=s((e,t,r,n)=>(J(e,t,"write to private field"),t.set(e,r),r),"__privateSet"),O;const nt=s(e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),"cleanInternalStack"),z=class z extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=t.map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=t.map(n=>typeof n.stack=="string"&&n.stack.length>0?nt(Qe(n.stack)):String(n)).join(`
`);r=`
`+qe(r,4),super(r),tt(this,O),Ze(this,"name","AggregateError"),rt(this,O,t)}get errors(){return et(this,O).slice()}};s(z,"AggregateError");let P=z;O=new WeakMap;const q=class q extends Error{constructor(t){super(),this.name="AbortError",this.message=t}};s(q,"AbortError");let W=q;const X=s(e=>globalThis.DOMException===void 0?new W(e):new DOMException(e),"getDOMException"),Z=s(e=>{const t=e.reason===void 0?X("This operation was aborted."):e.reason;return t instanceof Error?t:X(t)},"getAbortedReason");async function ot(e,t,{concurrency:r=Number.POSITIVE_INFINITY,stopOnError:n=!0,signal:o}={}){return new Promise((a,i)=>{if(e[Symbol.iterator]===void 0&&e[Symbol.asyncIterator]===void 0)throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof e})`);if(typeof t!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(r)||r===Number.POSITIVE_INFINITY)&&r>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);const p=[],f=[],u=new Map;let T=!1,_=!1,x=!1,b=0,E=0;const C=e[Symbol.iterator]===void 0?e[Symbol.asyncIterator]():e[Symbol.iterator](),w=s(c=>{T=!0,_=!0,i(c)},"reject");o&&(o.aborted&&w(Z(o)),o.addEventListener("abort",()=>{w(Z(o))}));const l=s(async()=>{if(_)return;const c=await C.next(),d=E;if(E++,c.done){if(x=!0,b===0&&!_){if(!n&&f.length>0){w(new P(f));return}if(_=!0,u.size===0){a(p);return}const g=[];for(const[v,y]of p.entries())u.get(v)!==ee&&g.push(y);a(g)}return}b++,(async()=>{try{const g=await c.value;if(_)return;const v=await t(g,d);v===ee&&u.set(d,v),p[d]=v,b--,await l()}catch(g){if(n)w(g);else{f.push(g),b--;try{await l()}catch(v){w(v)}}}})()},"next");(async()=>{for(let c=0;c<r;c++){try{await l()}catch(d){w(d);break}if(x||T)break}})()})}s(ot,"pMap");const ee=Symbol("skip"),te=["assert","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"];let k={};const st=s(e=>{const t=new H,r=new H;t.write=o=>{e("stdout",o)},r.write=o=>{e("stderr",o)};const n=new console.Console(t,r);for(const o of te)k[o]=console[o],console[o]=n[o];return()=>{for(const o of te)console[o]=k[o];k={}}},"patchConsole");var re,ne,oe,se,ie,le,ae,ce,ue,de,pe,fe,ge,ve,he,we,me,_e,ye,Te,be,xe,Ee,Ce,Ie,Se,Re,Oe,$e,Ae,Ne;const F=((re=globalThis.window)==null?void 0:re.document)!==void 0;(oe=(ne=globalThis.process)==null?void 0:ne.versions)==null||oe.node,(ie=(se=globalThis.process)==null?void 0:se.versions)==null||ie.bun,(ae=(le=globalThis.Deno)==null?void 0:le.version)==null||ae.deno,(ue=(ce=globalThis.process)==null?void 0:ce.versions)==null||ue.electron,(pe=(de=globalThis.navigator)==null?void 0:de.userAgent)==null||pe.includes("jsdom"),typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope,typeof DedicatedWorkerGlobalScope!="undefined"&&globalThis instanceof DedicatedWorkerGlobalScope,typeof SharedWorkerGlobalScope!="undefined"&&globalThis instanceof SharedWorkerGlobalScope,typeof ServiceWorkerGlobalScope!="undefined"&&globalThis instanceof ServiceWorkerGlobalScope;const S=(ge=(fe=globalThis.navigator)==null?void 0:fe.userAgentData)==null?void 0:ge.platform;S==="macOS"||((ve=globalThis.navigator)==null?void 0:ve.platform)==="MacIntel"||((we=(he=globalThis.navigator)==null?void 0:he.userAgent)==null?void 0:we.includes(" Mac "))===!0||((me=globalThis.process)==null||me.platform),S==="Windows"||((_e=globalThis.navigator)==null?void 0:_e.platform)==="Win32"||((ye=globalThis.process)==null||ye.platform),S==="Linux"||((be=(Te=globalThis.navigator)==null?void 0:Te.platform)==null?void 0:be.startsWith("Linux"))===!0||((Ee=(xe=globalThis.navigator)==null?void 0:xe.userAgent)==null?void 0:Ee.includes(" Linux "))===!0||((Ce=globalThis.process)==null||Ce.platform),S==="iOS"||((Ie=globalThis.navigator)==null?void 0:Ie.platform)==="MacIntel"&&((Se=globalThis.navigator)==null?void 0:Se.maxTouchPoints)>1||/iPad|iPhone|iPod/.test((Re=globalThis.navigator)==null?void 0:Re.platform),S==="Android"||((Oe=globalThis.navigator)==null?void 0:Oe.platform)==="Android"||((Ae=($e=globalThis.navigator)==null?void 0:$e.userAgent)==null?void 0:Ae.includes(" Android "))===!0||((Ne=globalThis.process)==null||Ne.platform);const $="\x1B[";!F&&D.env.TERM_PROGRAM,!F&&D.platform,F||D.cwd;const G=s((e=1)=>$+e+"A","cursorUp"),it=$+"?25l",lt=$+"?25h",B=$+"2K";var Me,De,j,Pe,We;const at=(We=(Pe=(j=(De=(Me=ze)==null?void 0:Me.WriteStream)==null?void 0:De.prototype)==null?void 0:j.hasColors)==null?void 0:Pe.call(j))!=null?We:!1,R=s((e,t)=>{if(!at)return o=>o;const r=`\x1B[${e}m`,n=`\x1B[${t}m`;return o=>{const a=o+"";let i=a.indexOf(n);if(i===-1)return r+a+n;let p=r,f=0;const T=(t===22?n:"")+r;for(;i!==-1;)p+=a.slice(f,i)+T,f=i+n.length,i=a.indexOf(n,f);return p+=a.slice(f)+n,p}},"format"),ct=R(2,22),ke=R(31,39),ut=R(32,39),A=R(33,39),L=R(90,39),Fe=["\u280B","\u2819","\u2839","\u2838","\u283C","\u2834","\u2826","\u2827","\u2807","\u280F"],N=!!(process.env.CI||process.env.CONTINUOUS_INTEGRATION||process.env.BUILD_NUMBER),dt=s(e=>process.env.NO_COLOR||process.env.NODE_DISABLE_COLORS?!1:e.hasColors?e.hasColors():process.env.FORCE_COLOR!==void 0?process.env.FORCE_COLOR!=="0":e.isTTY!==!1,"detectColors"),h=s((e,t,r)=>e?t(r):r,"colorize"),Ge=s(e=>{for(const t of e)if(t.state==="loading"||t.state==="pending"||t.children&&t.children.length>0&&!Ge(t.children))return!1;return!0},"areAllTasksDone"),pt=s((e,t=process.stdout)=>{let r=0,n,o,a="",i=0,p;const f=t.isTTY!==!1,u=dt(t),T=s((l,c)=>l==="pending"?h(u,L,"\u25FC"):l==="loading"?c?h(u,A,"\u276F"):h(u,A,Fe[r]):l==="success"?c?h(u,A,"\u276F"):h(u,ut,"\u2714"):l==="error"?c?h(u,ke,"\u276F"):h(u,ke,"\u2716"):l==="warning"?h(u,A,"\u26A0"):h(u,L,"\u25FC"),"getIcon"),_=s((l,c)=>{const d="  ".repeat(c),g=l.children&&l.children.length>0,v=T(l.state,g);let y=`${d}${v} ${l.title}`;if(l.status){const M=u?ct(`[${l.status}]`):`[${l.status}]`;y+=` ${M}`}if(y+=`
`,l.output){const M=`${d}  `,Le=s(I=>u?L(I):I,"styleText");y+=`${l.output.split(`
`).map((I,Ue)=>`${M}${Le(Ue===0?`\u2192 ${I}`:I)}`).join(`
`)}
`}return g&&(y+=x(l.children,c+1)),y},"renderTask"),x=s((l,c=0)=>l.map(d=>_(d,c)).join(""),"renderTaskList"),b=s((l,c)=>{if(i>0){for(let d=0;d<i;d+=1)t.write(B),t.write(G());i=0}t.write(c),E()},"handleConsoleOutput"),E=s(()=>{const l=x(e);if(Ge(e)&&n&&(clearInterval(n),n=void 0),N){l!==a&&(t.write(l),a=l);return}if(i>0)for(let d=0;d<i;d+=1)t.write(B),t.write(G());t.write(l),a=l,i=l.split(`
`).length-1},"render"),C=s(()=>{o||(o=setTimeout(()=>{o=void 0,E()},33))},"scheduleRender"),w=s(()=>{if(n&&clearInterval(n),o&&clearTimeout(o),p&&p(),!N&&f&&i>0)for(let l=0;l<i;l+=1)t.write(B),t.write(G());!N&&f&&t.write(lt)},"destroy");return!N&&f&&(t.write(it),n=setInterval(()=>{r=(r+1)%Fe.length,C()},80),p=st(b)),C(),{triggerRender:C,destroy:w}},"createRenderer");let U;const ft=s(e=>{U=e},"setRenderCallback"),gt=s(e=>new Proxy(e,{set(t,r,n){return Reflect.set(t,r,n),U&&U(),!0}}),"reactive"),Y=Symbol("run"),vt=s(e=>{const t={task:je(e.children),setTitle(r){e.title=r},setStatus(r){e.status=r},setOutput(r){e.output=typeof r=="string"?r:"message"in r?r.message:""},setWarning(r){e.state="warning",r!==void 0&&t.setOutput(r)},setError(r){e.state="error",r!==void 0&&t.setOutput(r)}};return t},"createTaskInnerApi");let m;const Be=s((e,t,r)=>{m||(m=pt(e),ft(()=>m.triggerRender()),e.isRoot=!0);const n=gt({title:t,state:"pending",children:[]});return e.push(n),{task:n,[Y]:async()=>{const o=vt(n);n.state="loading";let a;try{a=await r(o)}catch(i){throw o.setError(i),i}return n.state==="loading"&&(n.state="success"),a},clear:s(()=>{const o=e.indexOf(n);o!==-1&&e.splice(o,1),m&&m.triggerRender(),e.isRoot&&e.length===0&&m&&(m.destroy(),m=void 0)},"clear")}},"registerTask");function je(e){const t=s(async(r,n)=>{const o=Be(e,r,n);return{result:await o[Y](),get state(){return o.task.state},clear:o.clear}},"task");return t.group=(async(r,n)=>{const o=r((i,p)=>Be(e,i,p)),a=await ot(o,async i=>({result:await i[Y](),get state(){return i.task.state},clear:i.clear}),{concurrency:1,...n});return Object.assign(a,{clear:s(()=>{for(const i of o)i.clear()},"clear")})}),t}s(je,"createTaskFunction");const ht=[];var wt=je(ht);export{wt as default};
